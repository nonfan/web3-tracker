# 代币价格图表功能使用指南

## 功能概述

为代币添加了真实价格数据导入和图表展示功能，使用 CoinGecko 免费 API 获取历史价格数据。**数据会自动缓存1小时，避免频繁请求 API。**

## 使用方法

### 1. 导入真实价格数据

1. 在代币卡片右上角，点击**下载图标**（Download）按钮
2. 在弹出的对话框中搜索代币名称或符号（如：Bitcoin, BTC, Ethereum, ETH）
3. 选择时间范围（7天、14天、30天、90天、180天、365天）
4. 从搜索结果中选择正确的代币
   - 如果有缓存数据，会显示"缓存 X分钟"和"使用缓存"按钮
   - 如果没有缓存，会显示"导入"按钮
5. 点击按钮导入数据
6. 等待数据导入完成

### 2. 查看价格图表

1. 导入数据后，在代币卡片的投资/收益信息下方会显示"价格走势"按钮
2. 点击按钮打开价格图表弹窗
3. 图表显示：
   - 当前价格
   - 涨跌幅百分比
   - 历史价格折线图
   - 鼠标悬停查看具体数据点

### 3. 缓存管理

在顶部导航栏右侧，点击**数据库图标**打开缓存管理器：

- **查看统计**：缓存数量、大小、最早缓存时间
- **清理过期**：手动清理已过期的缓存
- **清除全部**：清除所有价格数据缓存

**缓存特性：**
- 自动缓存：导入的价格数据会自动缓存1小时
- 智能使用：再次导入相同代币和时间范围时，会优先使用缓存
- 自动清理：应用启动时会自动清理过期缓存
- 节省请求：避免频繁调用 API，提高响应速度

### 4. 生成测试数据（可选）

如果只是想测试图表功能，可以点击右上角的**图表图标**（LineChart）生成30天的模拟价格数据。

## 技术说明

### CoinGecko API

- **免费使用**：无需 API key
- **调用限制**：每分钟 10-50 次请求
- **数据来源**：CoinGecko 聚合了全球主要交易所的数据
- **支持代币**：10,000+ 种加密货币

### 缓存机制

- **存储位置**：浏览器 localStorage
- **缓存时长**：1小时
- **缓存策略**：
  - 首次导入：从 API 获取并缓存
  - 1小时内：直接使用缓存数据
  - 超过1小时：重新从 API 获取
- **缓存键**：`代币ID_天数`（如：`bitcoin_30`）

### 搜索技巧

1. **使用代币符号**：如 BTC, ETH, SOL（更精确）
2. **使用完整名称**：如 Bitcoin, Ethereum, Solana
3. **查看图标**：确认选择了正确的代币
4. **常见代币**：
   - Bitcoin (BTC)
   - Ethereum (ETH)
   - Solana (SOL)
   - BNB (BNB)
   - Cardano (ADA)
   - Polygon (MATIC)
   - Avalanche (AVAX)

### 支持的链平台

如果需要通过合约地址查询代币，支持以下平台：
- Ethereum
- BSC (Binance Smart Chain)
- Polygon
- Arbitrum
- Optimism
- Avalanche
- Base
- Solana

## 注意事项

1. **网络连接**：需要稳定的网络连接访问 CoinGecko API
2. **数据延迟**：价格数据可能有几分钟的延迟
3. **API 限制**：缓存机制已大幅减少 API 调用，正常使用不会触发限制
4. **数据存储**：
   - 价格历史保存在项目数据中
   - 缓存数据保存在 localStorage 中
   - 缓存不会自动更新，需要手动重新导入

## 性能优化

✅ **已实现的优化：**
- 智能缓存：相同请求1小时内直接使用缓存
- 自动清理：启动时清理过期缓存
- 缓存提示：显示缓存剩余时间
- 批量操作：支持一次导入多个代币

## 未来改进

- [ ] 自动刷新价格数据
- [ ] 支持多个时间周期切换
- [ ] 添加更多技术指标（MA、RSI等）
- [ ] 支持价格提醒功能
- [ ] 导出价格数据为 CSV
- [ ] 后台自动更新缓存

